---
title: "NCAA Project"
author: "Amber Duevel"
date: "9/22/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages}
library(dbplyr)
library(tidyverse)
library(dplyr)
```

```{r read in file}
ace_vb<-read_csv("VB_aces-1.csv")
assists_vb<-read_csv("VB_assists-1.csv")
blocks_vb<-read_csv("VB_blocks-1.csv")
digs_vb<-read_csv("VB_digs-1.csv")
hit_perc_vb<-read_csv("VB_hit_perc-1.csv")
kills_vb<-read_csv("VB_kills-1.csv")
opp_hits_vb<-read_csv("VB_opp_hits-1.csv")
WL_perc_vb<-read_csv("VB_WL_perc-1.csv")

```

```{r join data}
NCAA_full_set <- ace_vb %>% right_join(assists_vb, by="Team") %>% right_join(blocks_vb, by="Team") %>% right_join(digs_vb, by="Team") %>% right_join(hit_perc_vb, by="Team") %>% right_join(kills_vb, by="Team") %>% right_join(opp_hits_vb, by="Team") %>% right_join(WL_perc_vb, by="Team")

```

```{r clean data}
NCAA_full_set <- NCAA_full_set %>% select(-c("...1.x", "...1.y", "S.y", "...1.x.x","S.x.x", "...1.y.y", "S.y.y", "...1.x.x.x", "S.x.x.x","...1.y.y.y", "S.y.y.y", "...1.x.x.x.x", "S","...1.y.y.y.y","Rank.x","Rank.y","Rank.x.x", "Rank.y.y","Rank.x.x.x","Rank.y.y.y","Rank.x.x.x.x","Rank.y.y.y.y")) %>% distinct(Team, .keep_all = TRUE)
```

```{r rename}
NCAA_full_set <- rename(NCAA_full_set,c("Team_Name"="Team",
                                        "Sets"="S.x",
                                        "Aces"="Aces",
                                        "Per_Set_x"="Per Set.x",
                                        "Assists"="Assists", 
                                        "Per_Set_y"="Per Set.y",
                                        "Block_Solos"="Block Solos",
                                        "Block_Assists"="Block Assists",
                                        "Triple_Block"="TB",
                                        "Digs"="Digs",
                                        "Per_Set_xx"="Per Set.x.x",
                                        "Kills_x"="Kills.x",
                                        "Errors"="Errors", 
                                        "Total_Attacks"="Total Attacks",
                                        "Hitting_Percentage"="Pct..x",
                                        "Kills_y"="Kills.y",
                                        "Percentage_Set"="Per Set.y.y",
                                        "Opponents_Kill"="Opp Kills",
                                        "Opponents_Errors"="Opp Errors",
                                        "Opponents_Attacks"="Opp Attacks",
                                        "Opponents_Percentage"="Opp Pct",
                                        "Win"="W",
                                        "Lost"="L",
                                        "Percentage_Hits"="Pct..y"))

view(NCAA_full_set)
```
